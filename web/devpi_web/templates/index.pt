<!doctype html>
<html>
    <head>
        <title>${title}</title>
        <metal:head use-macro="request.macros['head']" />
    </head>
    <body>
        <metal:search use-macro="request.macros['navigation']" />
        <div id="content">
        <h1>${title}</h1>

        <ul>
            <li><a href="${simple_index_url}">simple index</a></li>
        </ul>

        <tal:packages condition="packages">
        <h2>in-stage latest packages, at least as recent as bases</h2>
        <table class="packages">
            <tr tal:repeat="package packages">
                <td><a href="${package.info.url}">${package.info.title}</a></td>
                <td>
                    <tal:files condition="package.files">
                        <tal:file repeat="file package.files">
                            <span tal:define="test_results file.get('test_results', []);
                                              failed None if not test_results else any(x['failed'] for x in test_results)"
                                  tal:omit-tag="failed is None"
                                  tal:attributes="class 'failed' if failed else 'passed'">
                                <a href="${file.url}">${file.title}</a>
                            </span>
                            <br tal:condition="not repeat.file.end" />
                        </tal:file>
                    </tal:files>
                </td>
                <td><a tal:condition="package.docs" href="${package.docs.url}">${package.docs.title}</a></td>
            </tr>
        </table>
        </tal:packages>

        <tal:bases condition="bases">
        <h2>inherited bases</h2>
        <ul>
            <li tal:repeat="base bases">
                <a href="${base.url}">${base.title}</a> (<a href="${base.simple_url}">simple</a>)
            </li>
        </ul>
        </tal:bases>
        </div>
    </body>
</html>
