<html>
    <head>
        <title>${title}</title>
        <metal:head use-macro="request.macros['head']" />
    </head>
    <body>
        <metal:search use-macro="request.macros['navigation']" />
        <div id="content">
        <h1>${title}</h1>

        <p class="projectnavigation">
            <tal:docs tal:condition="docs"><a href="${docs.url}">Documentation</a></tal:docs>
            <tal:home_page tal:condition="home_page"><a href="${home_page}">Homepage</a></tal:home_page>
        </p>
        <p id="summary" tal:condition="summary" tal:content="summary" />

        <table class="projectinfos">
            <tr tal:repeat="info infos">
                <td class="key">${info[0]}</td>
                <td class="value" tal:content="structure info[1]"></td>
            </tr>
        </table>

        <table class="files" tal:condition="files">
            <thead>
                <th>File</th>
                <th>Type</th>
                <th>Py Version</th>
                <th>Size</th>
                <th class="test_results" tal:condition="show_test_results">Test results</th>
                <th class="md5">MD5</th>
            </thead>
            <tbody>
                <tr tal:repeat="file files">
                    <td><a href="${file.url}">${file.title}</a></td>
                    <td>${file.dist_type}</td>
                    <td>${file.py_version}</td>
                    <td>${file.size}</td>
                    <td class="test_results" tal:condition="show_test_results">
                        <tal:test_results condition="file.get('test_results')">
                            <div tal:attributes="class 'testresult ' + ('failed' if test_result.failed else 'passed')" tal:repeat="test_result file.get('test_results')">
                                <div class="testresult_title">
                                    ${test_result.host} ${test_result.platform} ${test_result.envname} ${test_result.get('pyversion')}
                                </div>
                                <div class="command" tal:condition="not test_result.setup.commands">No setup performed</div>
                                <div
                                    tal:condition="test_result.setup.commands"
                                    tal:repeat="command test_result.setup.commands"
                                    tal:attributes="class 'command ' + ('failed' if command.failed else 'passed')">
                                    <div>
                                        Setup command:
                                        <pre>${command.command}</pre>
                                    </div>
                                    <div>
                                        Setup output:
                                        <pre>${command.output}</pre>
                                    </div>
                                </div>
                                <div class="command" tal:condition="not test_result.test.commands">No test run</div>
                                <div
                                    tal:condition="test_result.test.commands"
                                    tal:repeat="command test_result.test.commands"
                                    tal:attributes="class 'command ' + ('failed' if command.failed else 'passed')">
                                    <div>
                                        Test command:
                                        <pre>${command.command}</pre>
                                    </div>
                                    <div>
                                        Test output:
                                        <pre>${command.output}</pre>
                                    </div>
                                </div>
                            </div>
                        </tal:test_results>
                    </td>
                    <td class="md5"><code>${file.md5}</code></td>
                </tr>
            </tbody>
        </table>

        <div id="description" tal:content="structure content" />
        </div>
    </body>
</html>