[pytest]
norecursedirs = attic .tox 
addopts = -rs
rsyncdirs = devpi testing
rsyncignore = .tox

[tox]
envlist = version,py27,pytest26,pytest33,autoserver


[testenv]
deps = pytest 
       devpi-server>=0.9.2
       mock

commands = py.test {posargs}
           devpi server --stop



[testenv:version]
deps = 

commands = devpi --version

[testenv:pytest26]
basepython=python2.6
commands = py.test testing/test_pytestdevpi.py

[testenv:pytest33]
basepython=python3.3
commands = py.test testing/test_pytestdevpi.py

[testenv:autoserver]
deps = devpi-server
setenv =
    PYTHONDONTWRITEBYTECODE=

commands = 
    devpi server --stop  # make sure it's not interfering
    devpi --clientdir={envtmpdir} server --stop
    devpi --clientdir={envtmpdir} use 
    devpi --clientdir={envtmpdir} server
    devpi --clientdir={envtmpdir} server --stop
    devpi --clientdir={envtmpdir} use http://localhost:3141/root/dev/
    virtualenv newenv
    devpi --clientdir={envtmpdir} install --venv=newenv pytest
    devpi --clientdir={envtmpdir} server --stop

    
